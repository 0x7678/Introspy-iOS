Introspy
========

Blackbox tool to help understand what an iOS application is doing at runtime
and assist in the identification of potential security issues.


Description
-----------

Introspy comprises two separate modules: a tracer and an analyzer. 

The tracer component can be installed on a jailbroken device and dynamically
configured to hook security-sensitive iOS APIs at run-time. The tool records
details of relevant API calls made by the application, including function
calls, arguments and return values and persists them in a database.
Additionally, the calls can optionally be sent to the Console for real-time
analysis.

The Introspy analyzer can then be used to analyze a database generated by the
tracer, and generate HTML reports containing the list of logged function calls
as well as a list of potential vulnerabilities affecting the application.


Introspy Tracer
---------------

Users should first download the right pre-compiled Debian package:
-  https://www.dropbox.com/s/otag5l99b0slbbn/com.isecpartners.introspy_0.2.0-14_iphoneos-arm.deb?dl=1

### Dependencies

The tracer will only run on a jailbroken device. Using Cydia, make
sure the following packages are installed:
- dpkg
- MobileSubstrate
- PreferenceLoader
- Applist

### How to install

Download and copy the Debian package to the device; install it:  

    scp <package.deb> root@<device_ip>:~
    ssh root@<device_ip>
    dpkg -i <package.deb>

Respring the device:

    killall -HUP SpringBoard

There should be two new menus in the device's Settings. The Apps menu allows you
to select which applications will be profiled while the Settings menu defines
which API groups are being hooked.

Finally, kill and restart the App you want to monitor.

### How to uninstall

    dpkg -r com.isecpartners.introspy

### Groups and Subgroups

The following groups and subgroups correlate to filtering via the Settings menu
as well as during offline analysis using the command-line:
* Data Storage
  * File System
  * User Preferences
  * Keychain
* Crypto
  * Common Crypto
  * Security Framework
* Network
  * HTTP
* IPC
  * Pasteboard
  * URL Schemes
* Misc
  * XML

Introspy Analyzer
-----------------

The analyzer requires Python 2.6 or 2.7.

### Usage

The Introspy tracer should be first used on the application to be tested, i.e.,
by selecting it within the "Introspy - Apps" Settings menu. Then simply specify
the device IP address when you run the analysis tool.

    $ python introspy.py -l e-bank 192.168.1.127
    mobile@192.168.1.127's password:
    0. ./Applications/94656731-0259-4AE9-9EEE-BADC9244AD82/introspy-com.isecpartners.e-bank.db
    1. ./introspy-com.apple.mobilemail.db
    2. ./introspy-com.isecpartners.introspytestapp.db
    Select the database to analyze: 0

The example above will generate an HTML report for the com.isecpartners.e-bank
application within the newly created "e-bank" directory (specified by the -l
option). Notice that System application call databases are stored in
/var/mobile/ while user application dbs are maintained in that application's
directory.

Doing It Yourself
-----------------

### Building the Tracer From Source

Most users should just download and install the pre-compiled Debian package.
However, if you want to modify the library's functionality you will have to
clone the source repository and build the debian package yourself.

    git clone https://github.com/iSECPartners/introspy.git

The build requires the Theos suite to be installed; 
see http://www.iphonedevwiki.net/index.php/Theos/Getting\_Started .
You first have to create a symlink to your theos installation:

    cd introspy/
    ln -s /opt/theos/ ./theos

Then, the package can be built using:

    make package

### Installing the Tracer From Source

Once you've successfully created the debian package, you can use the Theos
Makefiles to automatically install the package and respring the device:

    export THEOS_DEVICE_IP=192.168.1.127
    make install

License
-------

See ./LICENSE.

Authors
-------

Tom Daniels
Alban Diquet
